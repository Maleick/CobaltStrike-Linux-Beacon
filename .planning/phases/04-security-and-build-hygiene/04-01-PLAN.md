---
phase: 04-security-and-build-hygiene
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [implant/src/http.c, implant-macos/src/http.c, generate-payload/validate_profile.py, generate-payload/render_profile_header.py, CustomBeacon.cna]
autonomous: true
requirements: [SEC-01]
---

<objective>
Implement TLS verification controls with secure defaults.

Purpose: Protect operator communication by verifying C2 certificates while allowing overrides for internal testing.
Output: Configurable SSL verification in beacon transport and operator UI.
</objective>

<execution_context>
@/Users/maleick/.gemini/get-shit-done/workflows/execute-plan.md
</execution_context>

<tasks>

<task type="auto">
  <name>Task 1: Update Beacon Transport logic</name>
  <files>implant/src/http.c, implant-macos/src/http.c</files>
  <action>
    - Modify `implant/src/http.c` and `implant-macos/src/http.c` to use `CURLOPT_SSL_VERIFYPEER` and `CURLOPT_SSL_VERIFYHOST` based on a `PROFILE_C2_VERIFY_SSL` macro.
    - If `PROFILE_C2_VERIFY_SSL` is defined as 1 (default), verification is enabled.
    - If 0, verification is disabled (insecure mode).
  </action>
  <verify>
    make -C implant TRANSPORT=http
    make -C implant-macos
  </verify>
  <done>HTTP transport respects the SSL verification configuration.</done>
</task>

<task type="auto">
  <name>Task 2: Extend Profile Schema and Rendering</name>
  <files>generate-payload/validate_profile.py, generate-payload/render_profile_header.py</files>
  <action>
    - Update `validate_profile.py` to allow the optional `ssl_ignore_verify` boolean field (defaulting to False).
    - Update `render_profile_header.py` to define `#define PROFILE_C2_VERIFY_SSL` based on this field.
  </action>
  <verify>
    python3 generate-payload/InsertListenerInfo.py --help
  </verify>
  <done>Generation scripts handle the new SSL verification field.</done>
</task>

<task type="auto">
  <name>Task 3: Update Aggressor UI</name>
  <files>CustomBeacon.cna</files>
  <action>
    - Add a `drow_checkbox` for "Verify SSL" to the generation dialog in `CustomBeacon.cna`.
    - Default the checkbox to checked.
    - Pass the value to `InsertListenerInfo.py`.
  </action>
  <verify>
    Visual check of CNA logic.
  </verify>
  <done>Operators can now control SSL verification from the Cobalt Strike UI.</done>
</task>

</tasks>

<verification>
Clean build of both beacons and verified propagation of SSL settings through the generation scripts.
</verification>

<success_criteria>
1. HTTPS beacons verify certificates by default.
2. Operator can disable verification via the Aggressor dialog.
3. Both Linux and macOS beacons support this configuration.
</success_criteria>

<output>
After completion, create `.planning/phases/04-security-and-build-hygiene/04-01-SUMMARY.md`
</output>
